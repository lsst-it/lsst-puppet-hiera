---
motd: |
  _    ___ ___ _____
  | |  / __/ __|_   _|
  | |__\__ \__ \ | |
  |____|___/___/ |_|
  Server controlled by puppet, configurations may be overwritten.
  Server configured to use Tucson configuration.
  Server installed in Rack %{::rack}, Room %{::room}
  Syslog messages sent to graylog, metrics to inflluxdb
  Any questions or suggestions forward it to IT.

ntp:
  ntp_server_1: "0.us.pool.ntp.org"
  ntp_server_2: "1.us.pool.ntp.org"
  ntp_server_3: "2.us.pool.ntp.org"

puppet_agent_run_interval: 3600
puppet_agent_service_state: "running"
puppet_master_server: "puppet-master.us.lsst.org"

firewalld_status: "running"
lsst_firewall_default_zone: "public"
lsst_firewall_default_target: "DROP"
lsst_firewall_default_sources:
  - 140.252.32.0/22
  - 140.252.115.0/24  # Steward Observatory
  - 140.252.201.0/24  # DMZ
  - 139.229.162.0/25  # Cerro Pachon
  - 139.229.136.0/24  # La Serena Base

#=============================================================================
# Monitoring Configuration
#=============================================================================
# Remote Logging and Graylog Configuration
#=============================================================================
rsyslog_host: "gs-graylog-node-01.po.us.lsst.org"
rsyslog_port: "5514"
rsyslog_proto: "udp"
rsyslog_patterns: "*.info;mail.none;authpriv.none;cron.none"

#=============================================================================
# Telegraf common configuration

monitoring_enabled: true
telegraf::global_tags:
  service: "%{::service}"
  cluster: "%{::cluster}"
  device: "%{::device}"
  service_number: "%{::service_number}"
  device_number: "%{::device_number}"
  node_name: "%{::node_name}"
  datacenter: "%{::datacenter}"
  enclave: "%{::enclave}"
  country: "%{::country}"
  room: "%{::room}"
  rack: "%{::rack}"
  type: "%{::virtual}"
telegraf::interval: "1m"
telegraf::round_interval: true
telegraf::metric_batch_size: 1000
telegraf::metric_buffer_limit: 10000
telegraf::collection_jitter: "0s"
telegraf::flush_interval: "1m"
telegraf::flush_jitter: "0m"
telegraf::debug: false
telegraf::quiet: false
telegraf::hostname: ""
telegraf::omit_hostname: false

IMS_Configuration:
  SSSD:
    sssd:
      - domains: ldap.ncsa.illinois.edu
      - config_file_version: 2
      - services: nss, pam, sudo
      - debug_level: 3
    nss:
      - filter_groups: root, qualys
      - filter_users: activemq,abrt,adm,apache,avahi,avahi-autoipd,bin,chronograf,chrony,condor,core,daemon,dbus,docker,elasticsearch,ftp,games,geoclue,grafana,graylog,graylog-web,grid,halt,hsqldb,influxdb,ldap,lp,mail,man,mongod,munge,myproxy,myproxyoauth,mysql,nagios,nfsnobody,nobody,nrpe,nscd,nslcd,ntp,operator,oprofile,oracle,ossec,pdagent,polkitd,postfix,postgres,puppet,rsbackup,qserv,qualys,root,rpc,rpcuser,saslauth,shutdown,simpleca,slurm,sshd,sssd,suiadmin,sync,syscore,systemd-bus-proxy,systemd-network,tcpdump,telegraf,tomcat,tss,ubuntu,unbound
      - override_homedir: /home/%u
      - allowed_shells: /bin/bash, bin/zsh
      - shell_fallback: /bin.bash
      - override_shell: /bin/bash
      - reconnection_retries: 3
    'domain/ldap.ncsa.illinois.edu':
      - timeout: 60
      - enumerate: false
      - id_provider: ldap
      - max_id: 1090519040
      - ldap_uri: ldaps://ldap.ncsa.illinois.edu
      - ldap_search_base: dc=ncsa,dc=illinois,dc=edu
      - ldap_tls_reqcert: demand
      - ldap_tls_cacert: /etc/pki/ca-trust/source/anchors/incommon-ca.pem
      - ldap_schema: rfc2307bis
      - ldap_group_member: uniqueMember
      - access_provider: simple
      - simple_allow_groups: prj_cerb_users
      - simple_deny_groups: all_disabled_usr, lsst_disabled
      - auth_provider: krb5
      - krb5_realm: NCSA.EDU
      - krb5_server: kerberos.ncsa.uiuc.edu, kerberos-1.ncsa.uiuc.edu, kerberos-2.ncsa.uiuc.edu
      - krb5_kpasswd: kadmin.ncsa.uiuc.edu
      - krb5_auth_timeout: 15
      - chpass_provider: krb5
      - krb5_lifetime: 25h
      - krb5_renewable_lifetime: 7d

#=============================================================================
# SAL Configuration common for Cerro Pachon
#=============================================================================

# Module variables
#####################################################
# Sal custom configuration
ts_sal::lsst_users_home_dir: "/home"
ts_sal::firewall_dds_zone_name: "lsst_zone"

ts_sal::ts_sal_path: "/opt/ts_sal"
ts_sal::ts_opensplice_path: "/opt/ts_opensplice"
ts_sal::ts_sal_repo: "https://github.com/lsst-ts/ts_sal.git"
ts_sal::ts_sal_branch: "master"
ts_sal::ts_opensplice_repo: "https://github.com/lsst-ts/ts_opensplice.git"
ts_sal::ts_opensplice_branch: "master"

ts_xml::ts_xml_path: "/opt/ts_xml"
ts_xml::ts_xml_repo: "https://github.com/lsst-ts/ts_xml.git"
ts_xml::ts_xml_branch: "master"
